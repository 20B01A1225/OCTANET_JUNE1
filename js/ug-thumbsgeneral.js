function UGThumbsGeneral(){var e,t,r,u,i=this,o=jQuery(i),h=new UniteGalleryMain,a=new UGFunctions;this.type={GET_THUMBS_ALL:"all",GET_THUMBS_RATIO:"ratio",GET_THUMBS_NO_RATIO:"no_ratio",GET_THUMBS_NEW:"new"},this.events={SETOVERSTYLE:"thumbmouseover",SETNORMALSTYLE:"thumbmouseout",SETSELECTEDSTYLE:"thumbsetselected",PLACEIMAGE:"thumbplaceimage",AFTERPLACEIMAGE:"thumb_after_place_image",IMAGELOADERROR:"thumbimageloaderror",THUMB_IMAGE_LOADED:"thumb_image_loaded"};var s={thumb_width:150,thumb_height:75,thumb_fixed_size:!0,thumb_resize_by:"height",thumb_border_effect:!0,thumb_border_width:0,thumb_border_color:"#000000",thumb_over_border_width:0,thumb_over_border_color:"#d9d9d9",thumb_selected_border_width:1,thumb_selected_border_color:"#d9d9d9",thumb_round_corners_radius:0,thumb_color_overlay_effect:!0,thumb_overlay_color:"#000000",thumb_overlay_opacity:.4,thumb_overlay_reverse:!1,thumb_image_overlay_effect:!1,thumb_image_overlay_type:"bw",thumb_transition_duration:200,thumb_transition_easing:"easeOutQuad",thumb_show_loader:!0,thumb_loader_type:"dark",thumb_wrapper_as_link:!1,thumb_link_newpage:!1},n={touchEnabled:!1,num_thumbs_checking:0,customThumbs:!1,funcSetCustomThumbHtml:null,isEffectBorder:!1,isEffectOverlay:!1,isEffectImage:!1,colorOverlayOpacity:1,thumbInnerReduce:0,allowOnResize:!0,classNewThumb:"ug-new-thumb"},m="thumb_size_change";function _(e,t){var i=r[e],o="";0==n.customThumbs&&(o=" ug-thumb-generated");var h="<div class='ug-thumb-wrapper"+o+"' "+("style='z-index:"+(i.index+1)+";'")+"></div>";if(1==s.thumb_wrapper_as_link){var a=i.link;""==i.link&&(a="javascript:void(0)");var m="";1==s.thumb_link_newpage&&i.link&&(m=" target='_blank'");h="<a href='"+a+"'"+m+" class='ug-thumb-wrapper"+o+"'></a>"}var _=jQuery(h),b=i.objThumbImage;if(0==n.customThumbs){if(1==s.thumb_show_loader&&b){var d="ug-thumb-loader-dark";"bright"==s.thumb_loader_type&&(d="ug-thumb-loader-bright"),_.append("<div class='ug-thumb-loader "+d+"'></div>"),_.append("<div class='ug-thumb-error' style='display:none'></div>")}if(b){if(b.addClass("ug-thumb-image"),1==s.thumb_image_overlay_effect){var c=b.clone().appendTo(_);c.addClass("ug-thumb-image-overlay "+t).removeClass("ug-thumb-image"),c.fadeTo(0,0),i.objImageOverlay=c}_.append(b)}}return n.isEffectBorder&&_.append("<div class='ug-thumb-border-overlay'></div>"),n.isEffectOverlay&&_.append("<div class='ug-thumb-overlay'></div>"),u.append(_),n.customThumbs&&n.funcSetCustomThumbHtml(_,i),r[e].objThumbWrapper=_,_}function b(e,t,r,i){var o={width:e+"px",height:t+"px"},h={width:e-n.thumbInnerReduce+"px",height:t-n.thumbInnerReduce+"px"},a=".ug-thumb-loader, .ug-thumb-error, .ug-thumb-border-overlay, .ug-thumb-overlay";r?(!0!==i&&r.css(o),r.find(a).css(h)):(u.children(".ug-thumb-wrapper").css(o),u.find(a).css(h))}function d(e,t,r,u){if(!u)u=!1;h.isFakeFullscreen()&&(u=!0);var i=e.children(".ug-thumb-border-overlay"),o={};o["border-width"]=t+"px",0!=t&&(o["border-color"]=r),u&&!0===u?(i.css(o),0==t?i.hide():i.show()):(0==t?i.stop().fadeOut(s.thumb_transition_duration):i.show().stop().fadeIn(s.thumb_transition_duration),function(e,t){e.stop(!0).animate(t,{duration:s.thumb_transition_duration,easing:s.thumb_transition_easing,queue:!1})}(i,o))}function c(e,t,r){var u=e.children(".ug-thumb-overlay"),i=s.thumb_transition_duration;r&&!0===r&&(i=0),t?u.stop(!0).fadeTo(i,n.colorOverlayOpacity):u.stop(!0).fadeTo(i,0)}function l(e,t,r){var u=e.children("img.ug-thumb-image"),i=e.children("img.ug-thumb-image-overlay"),o=s.thumb_transition_duration;r&&!0===r&&(o=0),t?i.stop(!0).fadeTo(o,1):(u.fadeTo(0,1),i.stop(!0).fadeTo(o,0))}function f(e,t){(n.isEffectBorder&&d(e,s.thumb_selected_border_width,s.thumb_selected_border_color,t),n.isEffectOverlay)&&c(e,1==s.thumb_overlay_reverse,t);n.isEffectImage&&l(e,!1,t),o.trigger(i.events.SETSELECTEDSTYLE,e)}function g(e){1==T(e)?f(e,!0):i.setThumbNormalStyle(e,!0,"redraw")}function v(e,t,r){if(1==s.thumb_fixed_size)a.scaleImageCoverParent(t,e);else{"height"==s.thumb_resize_by?a.scaleImageByHeight(t,s.thumb_height):a.scaleImageByWidth(t,s.thumb_width);var u=a.getElementSize(t);a.placeElement(t,0,0),b(u.width,u.height,e)}e.children(".ug-thumb-loader").hide(),t.show(),0==s.thumb_image_overlay_effect?t.fadeTo(0,1):(1==s.thumb_image_overlay_effect&&function(e){var t=e.siblings(".ug-thumb-image-overlay");if(0==t.length)return!1;var r=a.getElementSize(e),u={width:r.width+"px",height:r.height+"px",left:r.left+"px",top:r.top+"px"};t.css(u),0==n.customThumbs&&t.fadeTo(0,1)}(t),t.fadeTo(0,0),g(e)),o.trigger(i.events.AFTERPLACEIMAGE,e)}function T(e){return!!e.hasClass("ug-thumb-selected")}function y(e,t){t=jQuery(t);i.getItemByThumb(t);var r=a.getElementSize(t);b(r.width,r.height,t,!0),g(t)}function E(e,t){if(!t)t=!1;var r=jQuery(e),u=r.parents(".ug-thumb-wrapper");return 0!=u.parent().length&&(objItem=i.getItemByThumb(u),(1!=objItem.isLoaded||!1!==t)&&(i.triggerImageLoadedEvent(u,r),void(1==n.customThumbs?o.trigger(i.events.PLACEIMAGE,[u,r]):v(u,r,objItem))))}function p(e,t,r){objItem=i.getItemByThumb(t),objItem.isLoaded=!0,objItem.isThumbImageLoaded=!0;var u=a.getImageOriginalSize(r);objItem.thumbWidth=u.width,objItem.thumbHeight=u.height,objItem.thumbRatioByWidth=u.width/u.height,objItem.thumbRatioByHeight=u.height/u.width,t.addClass("ug-thumb-ratio-set")}this.init=function(u,i){e=u.getObjects(),h=u,jQuery(u),t=e.g_objWrapper,r=e.g_arrItems,s=jQuery.extend(s,i),n.isEffectBorder=s.thumb_border_effect,n.isEffectOverlay=s.thumb_color_overlay_effect,n.isEffectImage=s.thumb_image_overlay_effect},this._____________EXTERNAL_SETTERS__________=function(){},this.setHtmlThumbs=function(e,t){if(u=e,1==n.isEffectImage)var r=function(){var e="",t=s.thumb_image_overlay_type.split(",");for(var r in t){switch(t[r]){case"bw":e+=" ug-bw-effect";break;case"blur":e+=" ug-blur-effect";break;case"sepia":e+=" ug-sepia-effect"}}return e}();if(!0!==t)for(var o=h.getNumItems(),a=0;a<o;a++)_(a,r);else{i.getThumbs().removeClass(n.classNewThumb);var m=h.getNewAddedItemsIndexes();jQuery.each(m,(function(e,t){_(t,r).addClass(n.classNewThumb)}))}},this.setThumbNormalStyle=function(e,t,r){(1==n.customThumbs&&e.removeClass("ug-thumb-over"),n.isEffectBorder&&d(e,s.thumb_border_width,s.thumb_border_color,t),n.isEffectOverlay)&&c(e,1!=s.thumb_overlay_reverse,t);n.isEffectImage&&l(e,!0,t),o.trigger(i.events.SETNORMALSTYLE,e)},this.setThumbOverStyle=function(e){(1==n.customThumbs&&e.addClass("ug-thumb-over"),n.isEffectBorder&&d(e,s.thumb_over_border_width,s.thumb_over_border_color),n.isEffectOverlay)&&c(e,1==s.thumb_overlay_reverse);1==n.isEffectImage&&l(e,!1),o.trigger(i.events.SETOVERSTYLE,e)},this.setHtmlProperties=function(e){if(!e)e=i.getThumbs();if(0==n.customThumbs){1==s.thumb_fixed_size&&b(s.thumb_width,s.thumb_height,e),function(e){if(s.thumb_round_corners_radius<=0)return!1;var t={"border-radius":s.thumb_round_corners_radius+"px"};e?(e.css(t),e.find(".ug-thumb-border-overlay").css(t)):u.find(".ug-thumb-wrapper, .ug-thumb-wrapper .ug-thumb-border-overlay").css(t)}(e)}if(e.each((function(){g(jQuery(this))})),n.isEffectOverlay&&s.thumb_overlay_color){var t={};if(a.isRgbaSupported()){var r=a.convertHexToRGB(s.thumb_overlay_color,s.thumb_overlay_opacity);t["background-color"]=r}else t["background-color"]=s.thumb_overlay_color,n.colorOverlayOpacity=s.thumb_overlay_opacity;e.find(".ug-thumb-overlay").css(t)}},this.setThumbSelected=function(e){if(1==n.customThumbs&&e.removeClass("ug-thumb-over"),1==T(e))return!0;e.addClass("ug-thumb-selected"),f(e)},this.setThumbUnselected=function(e){e.removeClass("ug-thumb-selected"),i.setThumbNormalStyle(e,!1,"set unselected")},this.setOptions=function(e){s=jQuery.extend(s,e)},this.setThumbInnerReduce=function(e){n.thumbInnerReduce=e},this.setCustomThumbs=function(e,t,r){if(n.customThumbs=!0,"function"!=typeof e)throw new Error("The argument should be function");n.funcSetCustomThumbHtml=e,-1==jQuery.inArray("overlay",t)&&(n.isEffectOverlay=!1),-1==jQuery.inArray("border",t)&&(n.isEffectBorder=!1),n.isEffectImage=!1,r&&!1===r.allow_onresize&&(n.allowOnResize=!1)},this._____________EXTERNAL_GETTERS__________=function(){},this.getOptions=function(){return s},this.getNumThumbs=function(){return r.length},this.getThumbImage=function(e){return e.find(".ug-thumb-image")},this.getThumbByIndex=function(e){var t=i.getThumbs();if(e>=t.length||e<0)throw new Error("Wrong thumb index");return jQuery(t[e])},this.getThumbs=function(e){var t=".ug-thumb-wrapper",r=".ug-thumb-ratio-set";switch(e){default:case i.type.GET_THUMBS_ALL:var o=u.children(t);break;case i.type.GET_THUMBS_NO_RATIO:o=u.children(t).not(r);break;case i.type.GET_THUMBS_RATIO:o=u.children(t+r);break;case i.type.GET_THUMBS_NEW:o=u.children("."+n.classNewThumb)}return o},this.getItemByThumb=function(e){var t=e.data("index");return void 0===t&&(t=e.index()),r[t]},this.isThumbLoaded=function(e){return i.getItemByThumb(e).isLoaded},this.getGlobalThumbSize=function(){return{width:s.thumb_width,height:s.thumb_height}},this._____________EXTERNAL_OTHERS__________=function(){},this.initEvents=function(){var e=".ug-thumb-wrapper";1==n.allowOnResize&&t.on(m,y),o.on(i.events.THUMB_IMAGE_LOADED,p),u.on("touchstart",e,(function(){n.touchEnabled=!0,u.off("mouseenter").off("mouseleave")})),u.on("mouseenter",e,(function(e){!function(e){if(1==n.touchEnabled)return objThumbs.off("mouseenter").off("mouseleave"),!0;0==T(e)&&i.setThumbOverStyle(e)}(jQuery(this))})),u.on("mouseleave",e,(function(e){!function(e){if(1==n.touchEnabled)return!0;0==T(e)&&i.setThumbNormalStyle(e,!1)}(jQuery(this))}))},this.destroy=function(){var e=".ug-thumb-wrapper";u.off("touchstart",e),t.off(m),u.off("mouseenter",e),u.off("mouseleave",e),o.off(i.events.THUMB_IMAGE_LOADED)},this.loadThumbsImages=function(){var e=u.find(".ug-thumb-image");a.checkImagesLoaded(e,null,(function(e,t){0==t?E(e,!0):function(e){var t=i.getItemByThumb(e);if(t.isLoaded=!0,t.isThumbImageLoaded=!1,1==n.customThumbs)return o.trigger(i.events.IMAGELOADERROR,e),!0;e.children(".ug-thumb-loader").hide(),e.children(".ug-thumb-error").show()}(jQuery(e).parent())}))},this.triggerImageLoadedEvent=function(e,t){o.trigger(i.events.THUMB_IMAGE_LOADED,[e,t])},this.hideThumbs=function(){u.find(".ug-thumb-wrapper").hide()}}