function UGZoomSliderControl(){var e,t,i=new UGSlider,n=new UGFunctions,o={slider_zoom_step:1.2,slider_zoom_max_ratio:6,slider_zoom_return_pan_duration:400,slider_zoom_return_pan_easing:"easeOutCubic"},a={isPanActive:!1,startMouseX:0,startMouseY:0,lastMouseX:0,lastMouseY:0,startImageX:0,startImageY:0,panXActive:!1,panYActive:!1,objImage:null,objImageSize:null,objParent:null,objParentSize:null,objSlide:null,storeImageLastTime:0,isZoomActive:!1,startDistance:0,startMiddlePoint:null,imageOrientPoint:null,objFitImageSize:null,isZoomedOnce:!1};function r(n,r){i=n,t=jQuery(i),g_objects=n.getObjects(),e=g_objects.g_objSlider,g_objects.g_objInner,o=jQuery.extend(o,r),e.on("mousewheel",p),e.bind("mousedown touchstart",j),jQuery("body").bind("mousemove touchmove",f),jQuery(window).add("body").bind("mouseup touchend",I),t.bind(i.events.BEFORE_RETURN,(function(){c()})),t.bind(i.events.ITEM_CHANGED,(function(){a.isZoomedOnce=!1})),t.bind(i.events.ZOOM_CHANGE,(function(){a.isZoomedOnce=!0}))}function g(){var e=i.getScaleMode();return"down"!=e&&(e="fit"),e}function s(){if((o=jQuery.now())-a.storeImageLastTime<20)return!1;var e=i.getSlidesReference();if(a.objSlide=e.objCurrentSlide,a.objImage=e.objCurrentSlide.find("img"),0==a.objImage.length)return!1;a.objImageSize=n.getElementSize(a.objImage),a.objParent=a.objImage.parent(),a.objParentSize=n.getElementSize(a.objParent);var t=g();objPadding=i.getObjImagePadding(),a.objFitImageSize=n.getImageInsideParentDataByImage(a.objImage,t,objPadding);var o=jQuery.now();return a.storeImageLastTime=o,!0}function m(e,a){var r=i.getSlidesReference().objCurrentSlide.find("img"),s=g();t.trigger(i.events.ZOOM_START);var m=!0,u=i.getObjImagePadding();if("back"==e){var l=n.getImageOriginalSize(r);n.scaleImageFitParent(r,l.width,l.height,s,u)}else{var b="in"==e;m=n.zoomImageInsideParent(r,b,o.slider_zoom_step,a,s,o.slider_zoom_max_ratio,u)}1==m&&(t.trigger(i.events.ZOOMING),t.trigger(i.events.ZOOM_CHANGE),t.trigger(i.events.ZOOM_END))}function u(e,t,i){var o=n.getArrTouches(t);if(!0===i){if(1!=o.length)return!1}else if(o.length>1)return!1;return!!n.isElementBiggerThenParent(e)}function l(e){a.isPanActive=!0,function(e){var t=n.getMousePosition(e);a.startMouseX=t.pageX,a.startMouseY=t.pageY,a.lastMouseX=a.startMouseX,a.lastMouseY=a.startMouseY,a.startImageX=a.objImageSize.left,a.startImageY=a.objImageSize.top,a.panXActive=a.objImageSize.width>a.objParentSize.width,a.panYActive=a.objImageSize.height>a.objParentSize.height}(e)}function b(e){if(0==a.isZoomActive)return!1;2!=n.getArrTouches(e).length&&(a.isZoomActive=!1,t.trigger(i.events.ZOOM_END))}function d(e){if(1==a.isZoomActive)return!0;var o=n.getArrTouches(e);if(2!=o.length)return!0;!function(e){a.isZoomActive=!0,a.startDistance=n.getDistance(e[0].pageX,e[0].pageY,e[1].pageX,e[1].pageY),0==a.startDistance&&(a.startDistance=1),a.startMiddlePoint=n.getMiddlePoint(e[0].pageX,e[0].pageY,e[1].pageX,e[1].pageY),a.objImageSize=n.getElementSize(a.objImage),a.startImageX=a.objImageSize.left,a.startImageY=a.objImageSize.top,a.imageOrientPoint=n.getElementLocalPoint(a.startMiddlePoint,a.objImage),0==n.isPointInsideElement(a.imageOrientPoint,a.objImageSize)&&(a.imageOrientPoint=n.getElementCenterPoint(a.objImage)),t.trigger(i.events.ZOOM_START)}(o)}function c(){if(null==a.objImage||0==a.objImage.length)return!0;if(n.getElementSize(a.objImage).width<a.objFitImageSize.imageWidth){a.objImage.css({position:"absolute",margin:"none"});var e={top:a.objFitImageSize.imageTop+"px",left:a.objFitImageSize.imageLeft+"px",width:a.objFitImageSize.imageWidth+"px",height:a.objFitImageSize.imageHeight+"px"};a.objImage.animate(e,{duration:o.slider_zoom_return_pan_duration,easing:o.slider_zoom_return_pan_easing,queue:!1})}else!function(){var e=!1,t=!1,r=0,g=0,s=n.getElementSize(a.objImage),m=i.getObjImagePadding(),u=n.getElementCenterPosition(a.objImage,m);a.panXActive=a.objImageSize.width>a.objParentSize.width,a.panYActive=a.objImageSize.height>a.objParentSize.height,1==a.panYActive?s.top>0?(g=0,t=!0):s.bottom<a.objParentSize.height&&(g=a.objParentSize.height-s.height,t=!0):s.top!=u.top&&(t=!0,g=u.top),1==a.panXActive?s.left>0?(r=0,e=!0):s.right<a.objParentSize.width&&(r=a.objParentSize.width-s.width,e=!0):s.left!=u.left&&(e=!0,r=u.left);var l={};1==t&&(l.top=g+"px"),1==e&&(l.left=r+"px"),1!=t&&1!=e||a.objImage.animate(l,{duration:o.slider_zoom_return_pan_duration,easing:o.slider_zoom_return_pan_easing,queue:!1})}()}function j(e){if(0==i.isCurrentSlideType("image"))return!0;s();if(null==a.objImage||0==a.objImage.length)return!0;e.preventDefault(),1==!(!a.objImage||!a.objImage.is(":animated"))&&a.objImage.stop(!0),1==a.isZoomActive?b(e):d(e),1==a.isZoomActive?a.isPanActive=!1:1==u(a.objImage,e)&&1==a.isZoomedOnce&&l(e)}function I(e){if(0==i.isCurrentSlideType("image"))return!0;if(1==jQuery(e.target).data("ug-button"))return!1;s();if(null==a.objImage||0==a.objImage.length)return!0;var t=a.isPanActive,n=a.isZoomActive;if(0==i.isInnerInPlace())return a.isZoomActive=!1,a.isPanActive=!1,!0;if(1==a.isZoomActive?b(e):d(e),1==a.isZoomActive)a.isPanActive=!1;else{var o=u(a.objImage,e,!0);1==a.isPanActive?a.isPanActive=!1:1==o&&l(e)}(t||n)&&0==a.isZoomActive&&0==a.isPanActive&&c()}function f(e){if(0==i.isCurrentSlideType("image"))return!0;1==a.isZoomActive?function(e){var r=n.getArrTouches(e),g=n.getDistance(r[0].pageX,r[0].pageY,r[1].pageX,r[1].pageY)/a.startDistance,s=n.getMiddlePoint(r[0].pageX,r[0].pageY,r[1].pageX,r[1].pageY),m=a.objImageSize.width*g,u=a.objImageSize.height*g,l=n.getImageOriginalSize(a.objImage),b=1;if(l.width>0&&(b=m/l.width),b>o.slider_zoom_max_ratio)return!0;panX=-(a.imageOrientPoint.x*g-a.imageOrientPoint.x),panY=-(a.imageOrientPoint.y*g-a.imageOrientPoint.y);var d=s.x-a.startMiddlePoint.x,c=s.y-a.startMiddlePoint.y,j=a.startImageX+panX+d,I=a.startImageY+panY+c;n.setElementSizeAndPosition(a.objImage,j,I,m,u),t.trigger(i.events.ZOOMING),t.trigger(i.events.ZOOM_CHANGE)}(e):1==a.isPanActive&&function(e){if(null==a.objImage||0==a.objImage.length)return!0;var t=n.getMousePosition(e),o=(t.pageX,a.startMouseX,t.pageY,a.startMouseY,t.pageX-a.lastMouseX),r=t.pageY-a.lastMouseY,g=o<0?"left":"right",s=r<0?"up":"down";a.lastMouseX=t.pageX,a.lastMouseY=t.pageY;var m=n.getElementSize(a.objImage);0==a.panYActive?r=0:("down"==s&&m.top>0||"up"==s&&m.bottom<a.objParentSize.height)&&(r/=3),0==a.panXActive||0==i.isInnerInPlace()?o=0:("right"==g&&m.left>0||"left"==g&&m.right<a.objParentSize.width)&&(o/=3);var u=m.left+o,l=m.top+r;n.placeElement(a.objImage,u,l)}(e)}function p(e,t,a,r){return 0==o.slider_zoom_mousewheel||(0==i.isCurrentSlideType("image")||(e.preventDefault(),void m(1==t>0?"in":"out",n.getMousePosition(e))))}this.________EXTERNAL_____________=function(){},this.isPanEnabled=function(e,t){if(s(),null==a.objImage||0==a.objImage.length)return!1;if(0==a.isZoomedOnce)return!1;if(0==u(a.objImage,e))return!1;if(0==i.isInnerInPlace())return!1;if("left"==t){if(a.objImageSize.right<=a.objParentSize.width)return!1}else if(a.objImageSize.left>=0)return!1;return!0},this.init=function(e,t){r(e,t)},this.zoomIn=function(){m("in")},this.zoomOut=function(){m("out")},this.zoomBack=function(){m("back")}}