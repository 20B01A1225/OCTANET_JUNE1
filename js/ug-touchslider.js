function UGTouchSliderControl(){var e,t,i,s=new UGSlider,r=new UGFunctions,n={slider_transition_continuedrag_speed:250,slider_transition_continuedrag_easing:"linear",slider_transition_return_speed:300,slider_transition_return_easing:"easeInOutQuad"},a={touch_active:!1,startMouseX:0,startMouseY:0,lastMouseX:0,lastMouseY:0,startPosx:0,startTime:0,isInitDataValid:!1,slides:null,lastNumTouches:0,isDragging:!1,storedEventID:"touchSlider",videoStartX:0,isDragVideo:!1,videoObject:null};function o(e){if(!e)e=s.getSlidesReference();return-r.getElementSize(e.objCurrentSlide).left-r.getElementSize(t).left}function u(e){if(1==s.isInnerInPlace())return!1;if(i.trigger(s.events.BEFORE_RETURN),!e)e=s.getSlidesReference();var o=-r.getElementSize(e.objCurrentSlide).left;t.animate({left:o+"px"},{duration:n.slider_transition_return_speed,easing:n.slider_transition_continuedrag_easing,queue:!1,progress:function(e,i,s){if(1==a.isDragVideo){var n=r.getElementSize(t).left-o,u=a.videoStartX+n;a.videoObject.css("left",u)}},complete:function(){i.trigger(s.events.AFTER_RETURN)}})}function l(){var e=s.getSlidesReference(),l=o(e);if(0==l)return!1;var c=l>0?"left":"right",d=!1;switch(c){case"right":if(s.isSlideHasItem(e.objPrevSlide))var g=-r.getElementSize(e.objPrevSlide).left;else d=!0;break;case"left":if(s.isSlideHasItem(e.objNextSlide))g=-r.getElementSize(e.objNextSlide).left;else d=!0}1==d?u(e):t.stop().animate({left:g+"px"},{duration:n.slider_transition_continuedrag_speed,easing:n.slider_transition_continuedrag_easing,queue:!1,progress:function(){if(1==a.isDragVideo){var e=r.getElementSize(t).left-a.startPosx,i=a.videoStartX+e;a.videoObject.css("left",i)}},always:function(){!function(e){s.getVideoObject().hide(),s.switchSlideNums(e),s.placeNabourItems()}(c),i.trigger(s.events.AFTER_DRAG_CHANGE)}})}function c(e){var i=r.getMousePosition(e);a.startMouseX=i.pageX,a.startMouseY=i.pageY,a.lastMouseX=a.startMouseX,a.lastMouseY=a.startMouseY,a.startTime=jQuery.now();var s=r.getArrTouches(e);a.startArrTouches=r.getArrTouchPositions(s);var n=r.getElementSize(t);a.startPosx=n.left,a.isInitDataValid=!0,a.isDragVideo=!1,r.storeEventData(e,a.storedEventID)}function d(e){a.touch_active=!1}function g(e,t){a.touch_active=!0,c(t)}function f(e){return e.preventDefault(),a.isDragging=!1,1==s.isAnimating()&&t.stop(!0,!0),r.getArrTouches(e).length>1?(1==a.touch_active&&d(),!0):1==a.touch_active||void g(0,e)}function v(o){if(0==a.touch_active)return!0;if(0==o.buttons)return d(),l(),!0;r.updateStoredEventData(o,a.storedEventID),o.preventDefault();var u=r.getMousePosition(o);a.lastMouseX=u.pageX,a.lastMouseY=u.pageY;var g=null;1==n.slider_vertical_scroll_ondrag&&(g=r.handleScrollTop(a.storedEventID)),"vert"!==g&&function(r){var n=a.lastMouseX-a.startMouseX;if(0==n)return!0;var o=n<0?"left":"right",u=s.getObjZoom();if(u){if(1==u.isPanEnabled(r,o))return a.isInitDataValid=!1,!0;if(0==a.isInitDataValid)return c(r),!0}var l=a.startPosx+n;n>0&&l>0?l/=3:n<0&&l+t.width()<e.width()&&(l=a.startPosx+n/3);if(0==a.isDragging&&(a.isDragging=!0,i.trigger(s.events.START_DRAG)),t.css("left",l+"px"),1==a.isDragVideo){var d=l-a.startPosx,g=a.videoStartX+d;a.videoObject.css("left",g)}}(o)}function h(e){var t=r.getArrTouches(e).length;if(1==s.isInnerInPlace()&&0==a.touch_active&&0==t)return!0;if(0==t&&1==a.touch_active){d();var i=!1;0==r.wasVerticalScroll(a.storedEventID)&&(i=function(){var e=s.getSlidesReference(),t=o(e),i=Math.round(3*e.objCurrentSlide.width()/8);if(Math.abs(t)>=i)return!0;var r=Math.abs(a.lastMouseX-a.startMouseX);return Math.abs(a.lastMouseY-a.startMouseY),!(r<20)&&jQuery.now()-a.startTime<500}()),1==i?l():u()}else 1==t&&0==a.touch_active&&g(0,e)}this.isTapEventOccured=function(e){var t=r.getArrTouches(e).length;if(0!=t||0!=a.lastNumTouches)return a.lastNumTouches=t,!1;a.lastNumTouches=t;o(s.getSlidesReference());var i=Math.abs(a.lastMouseX-a.startMouseX),n=Math.abs(a.lastMouseY-a.startMouseY),u=jQuery.now()-a.startTime;return i<20&&n<50&&u<500},this.init=function(r,a){s=r,i=jQuery(s),g_objects=r.getObjects(),e=g_objects.g_objSlider,t=g_objects.g_objInner,n=jQuery.extend(n,a),e.bind("mousedown touchstart",f),jQuery("body").bind("mousemove touchmove",v),jQuery(window).add("body").bind("mouseup touchend",h)},this.getLastMousePos=function(){return{pageX:a.lastMouseX,pageY:a.lastMouseY}},this.isTouchActive=function(){return a.touch_active}}