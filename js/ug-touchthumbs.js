function UGTouchThumbsControl(){var t,e,i,n,o,s,a=new UGFunctions,r={touch_portion_time:200,thumb_touch_slowFactor:0,minDeltaTime:70,minPath:10,limitsBreakAddition:30,returnAnimateSpeed:500,animationEasing:"easeOutCubic",returnAnimationEasing:"easeOutCubic"},u={touch_active:!1,loop_active:!1,mousePos:0,innerPos:0,startPos:0,startTime:0,lastTime:0,buttonReleaseTime:0,lastPos:0,lastPortionPos:0,lastDeltaTime:0,lastDeltaPos:0,speed:0,handle:"",touchEnabled:!1,isControlEnabled:!0};function l(){var t=jQuery.now(),e={};return e.passedTime=u.lastTime-u.startTime,e.lastActiveTime=t-u.buttonReleaseTime,e.passedDistance=u.lastPos-u.startPos,e.passedDistanceAbs=Math.abs(e.passedDistance),e}function m(t){return 0==s?a.getMousePosition(t).pageX:a.getMousePosition(t).pageY}function c(){var t=jQuery.now();t-u.lastTime>=r.touch_portion_time&&(u.lastDeltaTime=t-u.lastTime,u.lastDeltaTime>r.touch_portion_time&&(u.lastDeltaTime=r.touch_portion_time),u.lastDeltaPos=u.lastPos-u.lastPortionPos,u.lastPortionPos=u.lastPos,u.lastTime=t)}function d(){u.lastPos=t.getInnerStripPos(),t.triggerStripMoveEvent()}function P(e){if(0==u.loop_active)return!0;if(e){m(e);!function(){var e=r.thumb_touch_slowFactor,i=r.minDeltaTime,o=r.minPath,a=t.getInnerStripPos(),l=jQuery.now()-u.lastTime,m=a-u.lastPortionPos;l<i&&u.lastDeltaTime>0&&(l=u.lastDeltaTime,m=u.lastDeltaPos+m),l<i&&(l=i);var c=0;l>0&&(c=m/l);var P=c*c/(2*e)*(m>0?1:-1);Math.abs(P)<=o&&(P=0);var p=t.getInnerStripPos(),v=p+P,h=t.fixInnerStripLimits(v),b=t.getInnerStripLimits(),g=r.limitsBreakAddition,f=!1,_=h;if(v>b.maxPos&&(f=!0,h=g,v<g&&(h=v)),v<b.minPos){f=!0;var T=b.minPos-g;h=T,v>T&&(h=v)}var D=h-p,y=Math.abs(Math.round(c/e));if(0!=P&&(y=y*D/P),p!=h){var S={left:h+"px"};1==s&&(S={top:h+"px"}),n.animate(S,{duration:y,easing:r.animationEasing,queue:!0,progress:d})}if(1==f){var w=r.returnAnimateSpeed,j={left:_+"px"};1==s&&(j={top:_+"px"}),n.animate(j,{duration:w,easing:r.returnAnimationEasing,queue:!0,progress:d})}}()}u.loop_active=!1,u.handle=clearInterval(u.handle)}function p(t){return 0==u.isControlEnabled||(u.buttonReleaseTime=jQuery.now(),0==u.touch_active?(P(t),!0):(t.preventDefault(),u.touch_active=!1,P(t),void i.removeClass("ug-dragging")))}function v(e){if(0==u.isControlEnabled)return!0;e.preventDefault(),u.touch_active=!0;var o=m(e);n.stop(!0),function(e){var i=t.getInnerStripPos();u.mousePos=e,u.innerPos=i,u.lastPortionPos=i,u.lastDeltaTime=0,u.lastDeltaPos=0,u.startTime=jQuery.now(),u.startPos=u.innerPos,u.lastTime=u.startTime,u.lastPos=u.startPos,u.speed=0}(o),function(){if(1==u.loop_active)return!0;u.loop_active=!0,u.handle=setInterval(c,10)}(),i.addClass("ug-dragging")}function h(e){if(0==u.isControlEnabled)return!0;if(0==u.touch_active)return!0;if(e.preventDefault(),0==e.buttons)return u.touch_active=!1,P(e),!0;var i=m(e);u.lastPos=t.getInnerStripPos(),function(e){var i=u.mousePos-e,n=u.innerPos-i,o=t.getInnerStripLimits();if(n>o.maxPos){var s=n-o.maxPos;n=o.maxPos+s/3}n<o.minPos&&(s=o.minPos-n,n=o.minPos-s/3);t.positionInnerStrip(n)}(i),c()}this.enable=function(){u.isControlEnabled=!0},this.disable=function(){u.isControlEnabled=!1},this.init=function(u){t=u,e=u.getObjects(),e.g_gallery,e.g_objGallery,i=e.g_objStrip,n=e.g_objStripInner,o=e.g_options,s=e.isVertical,r.thumb_touch_slowFactor=a.normalizeSetting(5e-5,.01,1,100,o.strip_thumb_touch_sensetivity,!0),i.bind("mousedown touchstart",v),jQuery(window).add("body").bind("mouseup touchend",p),jQuery("body").bind("mousemove touchmove",h)},this.isSignificantPassed=function(){var t=l();return t.passedTime>300||t.passedDistanceAbs>30},this.isTouchActive=function(){return 1==u.touch_active||(1==n.is(":animated")||l().lastActiveTime<50)},this.destroy=function(){i.unbind("mousedown"),i.unbind("touchstart"),jQuery(window).add("body").unbind("mouseup").unbind("touchend"),jQuery("body").unbind("mousemove").unbind("touchmove")}}