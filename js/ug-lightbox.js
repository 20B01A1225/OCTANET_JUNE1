function UGLightbox(){var e,t,i,o,n,l,s,r,a=this,_=jQuery(this),d=new UniteGalleryMain,g=new UGSlider,p=new UGFunctions,u=new UGTextPanel,h={lightbox_type:"wide",lightbox_show_textpanel:!0,lightbox_textpanel_width:550,lightbox_hide_arrows_onvideoplay:!0,lightbox_arrows_position:"sides",lightbox_arrows_offset:10,lightbox_arrows_inside_offset:10,lightbox_arrows_inside_alwayson:!1,lightbox_overlay_color:null,lightbox_overlay_opacity:1,lightbox_top_panel_opacity:null,lightbox_show_numbers:!0,lightbox_numbers_size:null,lightbox_numbers_color:null,lightbox_numbers_padding_top:null,lightbox_numbers_padding_right:null,lightbox_compact_closebutton_offsetx:1,lightbox_compact_closebutton_offsety:1,lightbox_close_on_emptyspace:!0};this.events={LIGHTBOX_INIT:"lightbox_init"};var f={topPanelHeight:44,initTextPanelHeight:26,isOpened:!1,isRightNowOpened:!1,putSlider:!0,isCompact:!1,fadeDuration:300,positionFrom:null,textPanelTop:null,textPanelLeft:null,isArrowsInside:!1,isArrowsOnHoverMode:!1,lastMouseX:null,lastMouseY:null,originalOptions:null,isSliderChangedOnce:!1,isTopPanelEnabled:!0},c={lightbox_slider_controls_always_on:!0,lightbox_slider_enable_bullets:!1,lightbox_slider_enable_arrows:!1,lightbox_slider_enable_progress_indicator:!1,lightbox_slider_enable_play_button:!1,lightbox_slider_enable_fullscreen_button:!1,lightbox_slider_enable_zoom_panel:!1,lightbox_slider_enable_text_panel:!1,lightbox_slider_scale_mode_media:"down",lightbox_slider_scale_mode:"down",lightbox_slider_loader_type:3,lightbox_slider_loader_color:"black",lightbox_slider_transition:"fade",lightbox_slider_image_padding_top:f.topPanelHeight,lightbox_slider_image_padding_bottom:0,lightbox_slider_video_padding_top:0,lightbox_slider_video_padding_bottom:0,lightbox_textpanel_align:"middle",lightbox_textpanel_padding_top:5,lightbox_textpanel_padding_bottom:5,slider_video_constantsize:!1,lightbox_slider_image_border:!1,lightbox_textpanel_enable_title:!0,lightbox_textpanel_enable_description:!1,lightbox_textpanel_desc_style_as_title:!0,lightbox_textpanel_enable_bg:!1,video_enable_closebutton:!1,lightbox_slider_video_enable_closebutton:!1,video_youtube_showinfo:!1,lightbox_slider_enable_links:!1},b={lightbox_overlay_opacity:.6,lightbox_slider_image_border:!0,lightbox_slider_image_shadow:!0,lightbox_slider_image_padding_top:30,lightbox_slider_image_padding_bottom:30,slider_video_constantsize:!0,lightbox_textpanel_align:"bottom",lightbox_textpanel_title_text_align:"left",lightbox_textpanel_desc_text_align:"left",lightbox_textpanel_padding_left:10,lightbox_textpanel_padding_right:10};function x(){1==f.isCompact&&1==h.lightbox_show_textpanel&&(h.lightbox_slider_image_padding_bottom=f.initTextPanelHeight),1==f.isCompact&&"inside"==h.lightbox_arrows_position&&(f.isArrowsInside=!0),1==f.isArrowsInside&&0==h.lightbox_arrows_inside_alwayson&&(f.isArrowsOnHoverMode=!0),0==h.lightbox_show_textpanel&&(f.isTopPanelEnabled=!1,f.topPanelHeight=0,h.lightbox_slider_image_padding_top=0)}function m(e){if(!g)return!0;var t={slider_image_padding_top:e};g.setOptions(t),g.refreshSlideItems()}function v(e){if(!r)return!1;if(!u)return!1;var t=r.height();if(0==t)return!1;if(0==r.is(":visible"))return!1;var i=t,o=u.getSize().height;t!=f.topPanelHeight&&(i=f.topPanelHeight),o>i&&(i=o),t!=i&&(r.height(i),g&&0==g.isAnimating()&&m(i))}function w(e){if(0==f.isOpened)return!1;if(!u)return!1;if(!g)return!1;var i=p.getElementSize(t),o=u.getSize();if(0==o.width||o.height>120)return!1;if(!e){var n=g.getSlideImage();e=p.getElementSize(n)}if(0==e.height||0==e.width)return!1;if(e.bottom+o.height<i.height)return!1;var l=g.getOptions(),s=o.height;if(s!=l.slider_image_padding_bottom){var r={slider_image_padding_bottom:s};if(0==g.isAnimating())return g.setOptions(r),g.refreshSlideItems(),!0}return!1}function y(e){p.getElementSize(t);var i=g.getSlideImage(),o=p.getElementSize(i);if(0==o.width)return!1;f.textPanelLeft=o.left,f.textPanelTop=o.bottom;var n=o.width;if(s){var l=p.getElementSize(s);n-=l.width;var r=o.right-l.width;p.placeElement(s,r,f.textPanelTop)}u&&(u.show(),u.refresh(!0,!0,n),function(e,t){if(!e){var i=g.getSlideImage();e=p.getElementSize(i)}f.textPanelTop=e.bottom,!0===t&&u.positionPanel(f.textPanelTop,f.textPanelLeft)}(o)),0==w(o)&&(f.positionFrom="handleCompactTextpanelSizes",u&&(u.positionPanel(f.textPanelTop,f.textPanelLeft),!0===e&&(e(),z())))}function T(){return 0==g.isCurrentSlideType("image")||1==g.isCurrentImageInPlace()}function E(e,t){if(0==f.isArrowsInside)return!1;if(!o)return!1;var i=T();if(o.show(),n.show(),f.positionFrom="positionArrowsInside",1==f.isArrowsOnHoverMode&&1==i&&0==C()&&j(!0),0==i)var l=p.getElementRelativePos(o,"left",h.lightbox_arrows_offset),s=p.getElementRelativePos(o,"middle"),r=p.getElementRelativePos(n,"right",h.lightbox_arrows_offset),a=s;else{var _=g.getSlideImage(),d=p.getElementSize(_);p.getElementSize(g.getElement()),l=p.getElementRelativePos(o,"left",0,_)+d.left+h.lightbox_arrows_inside_offset,s=p.getElementRelativePos(o,"middle",0,_)+d.top,r=p.getElementRelativePos(o,"right",0,_)+d.left-h.lightbox_arrows_inside_offset,a=s}if(!0===t){var u={left:l,top:s},c={left:r,top:a};o.stop().animate(u,{duration:f.fadeDuration}),n.stop().animate(c,{duration:f.fadeDuration})}else o.stop(),n.stop(),p.placeElement(o,l,s),p.placeElement(n,r,a);1==e&&R(t)}function S(e,i){f.positionFrom=null;var o=T(),n=p.getElementRelativePos(l,"right",2,t);if(0==o)var s=2,r=n;else{var a=g.getSlideImage(),_=p.getElementSize(a),d=p.getElementSize(g.getElement()),u=p.getElementSize(l);d.top==d.height&&(d.top=0);r=d.left+_.right-u.width/2+h.lightbox_compact_closebutton_offsetx;(s=d.top+_.top-u.height/2-h.lightbox_compact_closebutton_offsety)<2&&(s=2),r>n&&(r=n)}if(!0===i){var c={left:r,top:s};l.stop().animate(c,{duration:f.fadeDuration})}else l.stop(),p.placeElement(l,r,s);!0===e&&function(e){!0!==e&&l.stop();l.fadeTo(f.fadeDuration,1)}(i)}function A(){l&&l.stop().fadeTo(f.fadeDuration,0),I(),P(),f.positionFrom="hideCompactElements",1==f.isArrowsInside&&j()}function O(){var e=p.getElementSize(t);r&&p.setElementSizeAndPosition(r,0,0,e.width,f.topPanelHeight),o&&0==f.isArrowsInside&&(1==h.lightbox_hide_arrows_onvideoplay&&(o.show(),n.show()),p.placeElement(o,"left","middle",h.lightbox_arrows_offset),p.placeElement(n,"right","middle",h.lightbox_arrows_offset)),0==f.isCompact&&p.placeElement(l,"right","top",2,2),u&&(f.positionFrom="positionElements",0==f.isCompact?function(e){var t={},i=h.lightbox_textpanel_width;i>e.width-47-40?(t.textpanel_padding_left=47,t.textpanel_padding_right=40,t.textpanel_title_text_align="center",t.textpanel_desc_text_align="center"):(t.textpanel_padding_left=Math.floor((e.width-i)/2),t.textpanel_padding_right=t.textpanel_padding_left,t.textpanel_title_text_align="left",t.textpanel_desc_text_align="left",h.lightbox_textpanel_title_text_align&&(t.textpanel_title_text_align=h.lightbox_textpanel_desc_text_align),h.lightbox_textpanel_desc_text_align&&(t.textpanel_desc_text_align=h.lightbox_textpanel_desc_text_align)),u.setOptions(t),u.refresh(!0,!0),v(),u.positionPanel()}(e):(H(),z()));var i=e.width,s=e.height;if(g){if(r){var a={slider_image_padding_top:r.height()};g.setOptions(a)}g.setSize(i,s),g.setPosition(0,0)}}function I(){u&&u.getElement().stop().fadeTo(f.fadeDuration,0)}function P(){s&&s.stop().fadeTo(f.fadeDuration,0)}function C(){if(!f.lastMouseX)return!0;var e={pageX:f.lastMouseX,pageY:f.lastMouseY};return g.isMouseInsideSlideImage(e)}function j(e,t){return!!o&&(1==f.isArrowsOnHoverMode&&!1===t?(C(),!0):void(!0===e?(o.stop().fadeTo(0,0),n.stop().fadeTo(0,0)):(o.stop().fadeTo(f.fadeDuration,0),n.stop().fadeTo(f.fadeDuration,0))))}function R(e,t){return!!o&&(1==f.isArrowsOnHoverMode&&!0!==t&&1==T()||(1==g.isSwiping()||(!0!==e&&(o.stop(),n.stop()),o.fadeTo(f.fadeDuration,1),void n.fadeTo(f.fadeDuration,1))))}function M(e){if(!u)return!1;if(!e)e=g.getCurrentItem();u.setTextPlain(e.title,e.description)}function Q(e){if(!s)return!1;if(!e)e=g.getCurrentItem();var t=d.getNumItems(),i=e.index+1;s.html(i+" / "+t)}function H(){if(!u)return!1;u.getElement().show().stop().fadeTo(f.fadeDuration,1)}function z(){s&&s.stop().fadeTo(f.fadeDuration,1)}function N(){if(0==f.isCompact)return!0;A()}function D(){if(0==f.isCompact)return!0;(f.positionFrom="onZoomChange",S(!1,!0),E(!1,!0),1==f.isCompact)&&(0==(g.isCurrentSlideType("image")&&1==g.isCurrentImageInPlace())?(I(),P()):(f.positionFrom="onZoomChange",H(),z()))}function G(){if(0==f.isCompact)return!0;f.positionFrom="onSliderAfterReturn",S(!0),E(!0),0==w()&&y(),H(),z()}function L(e,t){return t=jQuery(t),0==f.isCompact||(0==g.isSlideCurrent(t)||(f.positionFrom="onSliderAfterPutImage",S(!0),E(!0),void y()))}function F(){var e=g.getOptions().slider_image_padding_top;if(r){var t=r.height();t!=e&&m(t)}if(1==f.isCompact){if(M(),Q(),f.positionFrom="onSliderTransitionEnd",S(!0),E(!0),0==g.isSlideActionActive())0==w()&&y();H(),z()}}function Y(e,t){0==f.isCompact?(s&&Q(t),u&&(M(t),0==f.isRightNowOpened&&(u.positionElements(!1),v(),u.positionPanel()))):0==g.isAnimating()&&(u&&M(t),s&&Q(t)),0==f.isSliderChangedOnce&&(f.isSliderChangedOnce=!0,_.trigger(a.events.LIGHTBOX_INIT))}function U(e,t){if("image"!=g.getSlideType()&&0==f.isCompact&&g.isSlideActionActive())return!0;if(1==g.isPreloading())return a.close("slider"),!0;1==h.lightbox_close_on_emptyspace&&(0==g.isMouseInsideSlideImage(t)&&a.close("slider_inside"))}function X(){O()}function k(){r?function(){if(!r)return!1;r.hide()}():s&&s.hide(),o&&1==h.lightbox_hide_arrows_onvideoplay&&(o.hide(),n.hide())}function B(){r?(!function(){if(!r)return!1;r.show()}(),v()):s&&s.show(),o&&1==h.lightbox_hide_arrows_onvideoplay&&(o.show(),n.show())}function K(e,t,i){var o=!1;switch(t){case 27:1==f.isOpened&&a.close("keypress");break;case 38:case 40:case 33:case 34:o=!0}1==f.isOpened&&1==o&&i.preventDefault()}function V(){1==f.isArrowsOnHoverMode&&R(!1,!0)}function Z(e){f.positionFrom="hideCompactElements",1==f.isArrowsOnHoverMode&&1==T()&&j(!1,!0)}function W(e){f.lastMouseX=e.pageX,f.lastMouseY=e.pageY,1==(!o||0==o.is(":visible")||1!=o.css("opacity"))&&C()&&0==g.isAnimating()&&(f.positionFrom="onMouseMove",o&&0==o.is(":animated")&&R(!1,!0))}function q(e,t,i,o){if(0==f.isOpened)return!0;switch(h.gallery_mousewheel_role){default:case"zoom":"image"!=g.getSlideType()&&e.preventDefault();break;case"none":e.preventDefault();break;case"advance":d.onGalleryMouseWheel(e,t,i,o)}}this.destroy=function(){if(jQuery(document).unbind("mousemove"),i.off("touchstart"),i.off("touchend"),l.off("click"),e.off(d.events.ITEM_CHANGE),g){jQuery(g).off(g.events.TRANSITION_END),jQuery(g).off(g.events.CLICK),jQuery(g).off(g.events.START_DRAG),jQuery(g).off(g.events.TRANSITION_START),jQuery(g).off(g.events.AFTER_DRAG_CHANGE),jQuery(g).off(g.events.AFTER_RETURN);var o=g.getVideoObject();jQuery(o).off(o.events.PLAY_START),jQuery(o).off(o.events.PLAY_STOP),jQuery(g).on(g.events.IMAGE_MOUSEENTER,V),jQuery(g).on(g.events.IMAGE_MOUSELEAVE,Z),g.destroy()}jQuery(window).unbind("resize"),e.off(d.events.GALLERY_KEYPRESS,K),t.off("mousewheel"),t.remove()},this.open=function(r){var a=d.getItem(r);(f.isOpened=!0,f.isRightNowOpened=!0,setTimeout((function(){f.isRightNowOpened=!1}),100),g&&g.setItem(a,"lightbox_open"),u&&u.setTextPlain(a.title,a.description),i.stop().fadeTo(0,0),t.show(),t.fadeTo(0,1),i.stop().fadeTo(f.fadeDuration,h.lightbox_overlay_opacity),O(),1==f.isCompact)&&(1==g.isPreloading()?(l&&l.hide(),o&&1==f.isArrowsInside&&(o.hide(),n.hide()),s&&s.hide(),u&&u.hide()):1==f.isArrowsInside&&(o.hide(),n.hide()));g&&g.startSlideAction(),e.trigger(d.events.OPEN_LIGHTBOX,a)},this.close=function(i){f.isOpened=!1,1==f.isCompact&&A(),g&&g.stopSlideAction(),"image"!=g.getSlideType()?t.hide():t.fadeTo(f.fadeDuration,0,(function(){t.hide()})),e.trigger(d.events.CLOSE_LIGHTBOX)},this.init=function(t,i){!function(t,i){d=t,e=jQuery(t),h=jQuery.extend(h,c),h=jQuery.extend(h,i),f.originalOptions=jQuery.extend({},h),"compact"==h.lightbox_type&&(f.isCompact=!0,h=jQuery.extend(h,b),h=jQuery.extend(h,i)),x(),1==f.putSlider?(d.initSlider(h,"lightbox"),g_objects=t.getObjects(),g=g_objects.g_objSlider):g=null,1==h.lightbox_show_textpanel?u.init(d,h,"lightbox"):u=null}(t,i)},this.putHtml=function(){var e,a;d.isSmallWindow()&&1==f.isCompact&&(f.isCompact=!1,x(),f.isArrowsInside=!1,f.isArrowsOnHoverMode=!1,(h=jQuery.extend({},f.originalOptions)).lightbox_arrows_position="sides",g.setOptions(h)),e="",a="",1==f.isCompact&&(a=" ug-lightbox-compact"),e+="<div class='ug-gallery-wrapper ug-lightbox"+a+"'>",e+="<div class='ug-lightbox-overlay'></div>",0==f.isCompact&&f.isTopPanelEnabled?(e+="<div class='ug-lightbox-top-panel'>",e+="<div class='ug-lightbox-top-panel-overlay'></div>",h.lightbox_show_numbers&&(e+="<div class='ug-lightbox-numbers'></div>"),e+="</div>"):h.lightbox_show_numbers&&(e+="<div class='ug-lightbox-numbers'></div>"),e+="<div class='ug-lightbox-button-close'></div>",e+="<div class='ug-lightbox-arrow-left'></div>",e+="<div class='ug-lightbox-arrow-right'></div>",e+="</div>",t=jQuery(e),jQuery("body").append(t),g&&g.setHtml(t),i=t.children(".ug-lightbox-overlay"),0==f.isCompact&&1==f.isTopPanelEnabled&&0==(r=t.children(".ug-lightbox-top-panel")).length&&(r=null),l=t.find(".ug-lightbox-button-close"),h.lightbox_show_numbers&&(s=t.find(".ug-lightbox-numbers")),o=t.children(".ug-lightbox-arrow-left"),n=t.children(".ug-lightbox-arrow-right"),u&&(r?u.appendHTML(r):u.appendHTML(t))},this.run=function(){!function(){if(null!==h.lightbox_overlay_color&&i.css("background-color",h.lightbox_overlay_color),null!==h.lightbox_overlay_opacity&&i.fadeTo(0,h.lightbox_overlay_opacity),r&&null!==h.lightbox_top_panel_opacity&&r.children(".ug-lightbox-top-panel-overlay").fadeTo(0,h.lightbox_top_panel_opacity),s){var e={};null!==h.lightbox_numbers_size&&(e["font-size"]=h.lightbox_numbers_size+"px"),h.lightbox_numbers_color&&(e.color=h.lightbox_numbers_color),null!==h.lightbox_numbers_padding_right&&(e["padding-right"]=h.lightbox_numbers_padding_right+"px"),null!==h.lightbox_numbers_padding_top&&(e["padding-top"]=h.lightbox_numbers_padding_top+"px"),s.css(e)}}(),g&&g.run(),function(){if(i.on("touchstart",(function(e){e.preventDefault()})),i.on("touchend",(function(e){a.close("overlay")})),p.addClassOnHover(n,"ug-arrow-hover"),p.addClassOnHover(o,"ug-arrow-hover"),p.addClassOnHover(l),d.setNextButton(n),d.setPrevButton(o),l.click((function(){a.close("button")})),e.on(d.events.ITEM_CHANGE,Y),g){jQuery(g).on(g.events.TRANSITION_END,F),jQuery(g).on(g.events.CLICK,U);var s=g.getVideoObject();jQuery(s).on(s.events.PLAY_START,k),jQuery(s).on(s.events.PLAY_STOP,B),jQuery(g).on(g.events.START_DRAG,N),jQuery(g).on(g.events.TRANSITION_START,N),jQuery(g).on(g.events.AFTER_DRAG_CHANGE,G),jQuery(g).on(g.events.AFTER_RETURN,G),jQuery(g).on(g.events.AFTER_PUT_IMAGE,L),jQuery(g).on(g.events.ZOOM_CHANGE,D),jQuery(g).on(g.events.IMAGE_MOUSEENTER,V),jQuery(g).on(g.events.IMAGE_MOUSELEAVE,Z)}jQuery(window).resize((function(){if(0==f.isOpened)return!0;p.whenContiniousEventOver("lightbox_resize",X,100)})),e.on(d.events.GALLERY_KEYPRESS,K),1==f.isArrowsOnHoverMode&&jQuery(document).bind("mousemove",W),t.on("mousewheel",q)}()}}