function UGThumbsStrip(){var t,e,n,r,s,o,u,p,_=this,h=new UniteGalleryMain,c=new UGFunctions,a=!1,m=new UGThumbsGeneral,d=(c=new UGFunctions,{strip_vertical_type:!1,strip_thumbs_align:"center",strip_space_between_thumbs:8,strip_thumb_touch_sensetivity:15,strip_scroll_to_thumb_duration:500,strip_scroll_to_thumb_easing:"easeOutCubic",strip_control_avia:!0,strip_control_touch:!0,strip_padding_top:0,strip_padding_bottom:0,strip_padding_left:0,strip_padding_right:0}),l={isRunOnce:!1,is_placed:!1,isNotFixedThumbs:!1,handle:null},g={stripSize:0,stripActiveSize:0,stripInnerSize:0,thumbSize:0,thumbSecondSize:0};this.events={STRIP_MOVE:"stripmove",INNER_SIZE_CHANGE:"size_change"};var b={strip_thumbs_align:"top",thumb_resize_by:"width"};function f(){var t=m.getOptions();l.isNotFixedThumbs=!1===t.thumb_fixed_size,a=d.strip_vertical_type}function S(){var i,e,n,r,c;m.setHtmlProperties(),i=o.children(".ug-thumb-wrapper"),e=jQuery(i[0]),n=e.outerWidth(),r=e.outerHeight(),c=m.getOptions(),0==a?(g.thumbSize=n,1==c.thumb_fixed_size?g.thumbSecondSize=r:g.thumbSecondSize=c.thumb_height,v(s.width()),g.stripInnerSize=o.width()):(g.thumbSize=r,1==c.thumb_fixed_size?g.thumbSecondSize=n:g.thumbSecondSize=c.thumb_width,v(s.height()),g.stripInnerSize=o.height()),function(){if(0==a){var t=g.thumbSecondSize;(i={}).height=t+"px",(e={}).height=t+"px"}else{var i,e,n=g.thumbSecondSize;(i={}).width=n+"px",(e={}).width=n+"px"}s.css(i),o.css(e)}(),z(),0==l.isRunOnce&&(1==d.strip_control_touch&&(p=new UGTouchThumbsControl).init(_),1==d.strip_control_avia&&(u=new UGAviaControl).init(_),w(),m.loadThumbsImages(),m.initEvents(),s.find(".ug-thumb-wrapper").on("click touchend",(function(t){!function(t){if(_.isTouchMotionActive()&&1==p.isSignificantPassed())return!0;var i=m.getItemByThumb(t);h.selectItem(i)}(jQuery(this))})),t.on(h.events.ITEM_CHANGE,j),l.isNotFixedThumbs&&jQuery(m).on(m.events.AFTERPLACEIMAGE,y)),l.isRunOnce=!0}function v(t){g.stripSize=t,g.stripActiveSize=0==a?g.stripSize-d.strip_padding_left-d.strip_padding_right:g.stripSize-d.strip_padding_top-d.strip_padding_bottom,g.stripActiveSize<0&&(g.stripActiveSize=0)}function z(){var t,e=o.children(".ug-thumb-wrapper"),n=0,r=0;for(0==a&&(r=d.strip_padding_top),i=0;i<e.length;i++){var s=jQuery(e[i]);if(1==l.isNotFixedThumbs){if(objItem=m.getItemByThumb(s),0==objItem.isLoaded)continue;s.show()}c.placeElement(s,n,r),0==a?n+=s.outerWidth()+d.strip_space_between_thumbs:r+=s.outerHeight()+d.strip_space_between_thumbs}if(0==a)var u=n-d.strip_space_between_thumbs;else u=r-d.strip_space_between_thumbs;t=u,0==a?o.width(t):o.height(t),g.stripInnerSize=t,w(),jQuery(_).trigger(_.events.INNER_SIZE_CHANGE)}function T(t){var i=_.getInnerStripPos()+t;i=_.fixInnerStripLimits(i),_.positionInnerStrip(i,!0)}function I(t){var i=-1*P(t).min;i=_.fixInnerStripLimits(i),_.positionInnerStrip(i,!0)}function x(t){var i=-1*P(t).max+g.stripSize;i=_.fixInnerStripLimits(i),_.positionInnerStrip(i,!0)}function E(t){if(0==A())return!1;var i,e,n=(i={},e=_.getInnerStripPos(),i.minPosThumbs=-1*e+1,i.maxPosThumbs=-1*e+g.stripSize-1,i),r=P(t);if(r.min<n.minPosThumbs){var s=t.prev();s.length?I(s):I(t)}else if(r.max>n.maxPosThumbs){var o=t.next();o.length?x(o):x(t)}}function w(){1==A()?(u&&u.enable(),p&&p.enable()):(u&&u.disable(),p&&p.disable())}function y(){clearTimeout(l.handle),l.handle=setTimeout((function(){z()}),50)}function j(){var t=h.getSelectedItem();m.setThumbSelected(t.objThumbWrapper),E(t.objThumbWrapper)}function A(){return g.stripInnerSize>g.stripActiveSize}function P(t){var i={},e=t.position();return 0==a?(i.min=e.left,i.max=e.left+g.thumbSize):(i.min=e.top,i.max=e.top+g.thumbSize),i}this.setHtml=function(t){if(!t){t=n;null!=d.parent_container&&(t=d.parent_container)}t.append("<div class='ug-thumbs-strip'><div class='ug-thumbs-strip-inner'></div></div>"),s=t.children(".ug-thumbs-strip"),o=s.children(".ug-thumbs-strip-inner"),m.setHtmlThumbs(o),1==l.isNotFixedThumbs&&m.hideThumbs()},this.destroy=function(){var i=s.find(".ug-thumb-wrapper");i.off("click"),i.off("touchend"),t.off(h.events.ITEM_CHANGE),jQuery(m).off(m.events.AFTERPLACEIMAGE),p&&p.destroy(),u&&u.destroy(),m.destroy()},this.________EXTERNAL_GENERAL___________=function(){},this.init=function(i,s){!function(i,s){e=i.getObjects(),(h=i).attachThumbsPanel("strip",_),t=jQuery(i),n=e.g_objWrapper,r=e.g_arrItems,d=jQuery.extend(d,s),1==(a=d.strip_vertical_type)&&(d=jQuery.extend(d,b),d=jQuery.extend(d,s),s.thumb_resize_by="width"),m.init(i,s),f()}(i,s)},this.run=function(){S()},this.positionInnerStrip=function(t,i){if(void 0===i)i=!1;if(0==a)var e={left:t+"px"};else e={top:t+"px"};0==i?(o.css(e),_.triggerStripMoveEvent()):(_.triggerStripMoveEvent(),o.stop(!0).animate(e,{duration:d.strip_scroll_to_thumb_duration,easing:d.strip_scroll_to_thumb_easing,queue:!1,progress:function(){_.triggerStripMoveEvent()},always:function(){_.triggerStripMoveEvent()}}))},this.triggerStripMoveEvent=function(){jQuery(_).trigger(_.events.STRIP_MOVE)},this.isTouchMotionActive=function(){return!!p&&p.isTouchActive()},this.isItemThumbVisible=function(t){var i=t.objThumbWrapper,e=i.position(),n=-1*_.getInnerStripPos();if(0==a)var r=n+g.stripSize,s=e.left,o=e.left+i.width();else r=n+g.stripSize,s=e.top,o=e.top+i.height();var u=!1;return o>=n&&s<=r&&(u=!0),u},this.getInnerStripPos=function(){return 0==a?o.position().left:o.position().top},this.getInnerStripLimits=function(){var t={};return t.maxPos=0==a?d.strip_padding_left:d.strip_padding_top,t.minPos=-(g.stripInnerSize-g.stripActiveSize),t},this.fixInnerStripLimits=function(t){var i=_.getInnerStripLimits();return t>i.maxPos&&(t=i.maxPos),t<i.minPos&&(t=i.minPos),t},this.scrollForeward=function(){T(-g.stripSize)},this.scrollBack=function(){T(g.stripSize)},this.________EXTERNAL_SETTERS___________=function(){},this.setOptions=function(t){d=jQuery.extend(d,t),m.setOptions(t),f()},this.setSizeVertical=function(t){if(0==a)throw new Error("setSizeVertical error, the strip size is not vertical");var i=g.thumbSecondSize,e={};e.width=i+"px",e.height=t+"px",s.css(e),v(t);var n={};n.width=i+"px",n.left="0px",n.top="0px",o.css(n),l.is_placed=!0,w()},this.setSizeHorizontal=function(t){if(1==a)throw new Error("setSizeHorizontal error, the strip size is not horizontal");var i=g.thumbSecondSize+d.strip_padding_top+d.strip_padding_bottom,e={};e.width=t+"px",e.height=i+"px",s.css(e),v(t);var n=d.strip_padding_left,r={};r.height=i+"px",r.left=n+"px",r.top="0px",o.css(r),l.is_placed=!0,w()},this.setPosition=function(t,i,e,n){c.placeElement(s,t,i,e,n)},this.resize=function(t){0==a?(s.width(t),g.stripActiveSize=t-d.strip_padding_left-d.strip_padding_right):(s.height(t),g.stripActiveSize=t-d.strip_padding_top-d.strip_padding_bottom),v(t),w(),function(){if(0==A())return!1;var t=_.getInnerStripPos(),i=_.fixInnerStripLimits(t);t!=i&&_.positionInnerStrip(i,!0)}(),function(){if(A())return!1;0==a?c.placeElement(o,d.strip_thumbs_align,0):c.placeElement(o,0,d.strip_thumbs_align)}(),function(){var t=h.getSelectedItem();if(null==t)return!0;var i=t.objThumbWrapper;i&&E(i)}()},this.setThumbUnselected=function(t){m.setThumbUnselected(t)},this.setCustomThumbs=function(t){m.setCustomThumbs(t)},this.________EXTERNAL_GETTERS___________=function(){},this.getObjects=function(){var i=m.getOptions(),e=jQuery.extend(d,i);return{g_gallery:h,g_objGallery:t,g_objWrapper:n,g_arrItems:r,g_objStrip:s,g_objStripInner:o,g_aviaControl:u,g_touchThumbsControl:p,isVertical:a,g_options:e,g_thumbs:m}},this.getObjThumbs=function(){return m},this.getSelectedThumb=function(){var t=h.getSelectedItemIndex();return-1==t?null:m.getThumbByIndex(t)},this.getSizeAndPosition=function(){return c.getElementSize(s)},this.getHeight=function(){return s.outerHeight()},this.getWidth=function(){return s.outerWidth()},this.getSizes=function(){return g},this.isVertical=function(){return a},this.isPlaced=function(){return l.is_placed},this.isMoveEnabled=function(){return A()}}